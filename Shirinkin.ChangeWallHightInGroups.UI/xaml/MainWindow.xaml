<Window
    x:Class="Shirinkin.ChangeWallHightInGroups.UI.xaml.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="clr-namespace:Shirinkin.ChangeWallHightInGroups.UI.xaml"
    xmlns:vm="clr-namespace:Shirinkin.ChangeWallHightInGroups.UI.VM"
    mc:Ignorable="d"
    Height="600"
    Width="800"
    d:DataContext="{d:DesignInstance Type=vm:MainVM, IsDesignTimeCreatable=True}"
    Loaded="Window_Loaded">
    <Window.Resources>
        <vm:BoolToVisibilityConverter
            x:Key="BoolToVisibilityConverter" />
    </Window.Resources>
    <Grid
        Margin="10">
        <StackPanel
            Orientation="Vertical">
            <TextBlock
                Text="Выберите линии контура, внутри которого изменять группы" />
            <TextBlock
                Text="По умолчанию выбраны все объекты типа DetailLine, вот их ID:"
                Margin="0 10 0 0" />
            <ListBox
                MinHeight="100"
                ItemsSource="{Binding SelectedLines}"
                Margin="0 10 0 0">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock
                            Text="{Binding ID}" />
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
            <Button
                Margin="0 10 0 0"
                Content="Выбрать на виде"
                HorizontalAlignment="Left"
                Padding="5"
                Command="{Binding SelectLinesOnViewCommand}" />
            <Separator
                Margin="0 10 0 10" />
            <TextBlock
                Text="Выберите тип группы, который хотите изменить. Будет создан новый тип группы и применён к группам, которые находятся в замкнутой области между линиями. К элементам группы будет применена операция изменнеия смещения сверху для стен на -200."
                TextWrapping="Wrap" />
            <ComboBox
                HorizontalAlignment="Left"
                MinWidth="100"
                ItemsSource="{Binding PosibleGroupTypes}"
                SelectedValue="{Binding SelectedGroupType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <TextBlock
                            Text="{Binding Name}" />
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>
            <TextBlock
                Text="Введите название для новой группы"
                Margin="0 10 0 0" />
            <TextBox
                Text="{Binding NewNameOfGroupType, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
            <Button
                HorizontalAlignment="Left"
                Margin="0 10 0 0"
                Command="{Binding ExecuteOperationCommand}">
                <Grid>
                    <ProgressBar
                        IsIndeterminate="True"
                        Visibility="{Binding OperationIsRunning, Converter={StaticResource BoolToVisibilityConverter}}" />
                    <TextBlock
                        Text="Выполнить операцию"
                        Margin="5" />
                </Grid>
            </Button>
            <TextBlock
                Text="{Binding ResultText}" 
                Margin="0 10 0 0"
                TextWrapping="Wrap"/>
        </StackPanel>
    </Grid>
</Window>
